/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/alpinejs@3.14.9/src/evaluator.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{closestDataStack,mergeProxies}from"./scope";import{injectMagics}from"./magics";import{tryCatch,handleError}from"./utils/error";let shouldAutoEvaluateFunctions=!0;export function dontAutoEvaluateFunctions(t){let e=shouldAutoEvaluateFunctions;shouldAutoEvaluateFunctions=!1;let r=t();return shouldAutoEvaluateFunctions=e,r}export function evaluate(t,e,r={}){let n;return evaluateLater(t,e)((t=>n=t),r),n}export function evaluateLater(...t){return theEvaluatorFunction(...t)}let theEvaluatorFunction=normalEvaluator;export function setEvaluator(t){theEvaluatorFunction=t}export function normalEvaluator(t,e){let r={};injectMagics(r,t);let n=[r,...closestDataStack(t)],o="function"==typeof e?generateEvaluatorFromFunction(n,e):generateEvaluatorFromString(n,e,t);return tryCatch.bind(null,t,e,o)}export function generateEvaluatorFromFunction(t,e){return(r=()=>{},{scope:n={},params:o=[]}={})=>{runIfTypeOfFunction(r,e.apply(mergeProxies([n,...t]),o))}}let evaluatorMemo={};function generateFunctionFromString(t,e){if(evaluatorMemo[t])return evaluatorMemo[t];let r=Object.getPrototypeOf((async function(){})).constructor,n=/^[\n\s]*if.*\(.*\)/.test(t.trim())||/^(let|const)\s/.test(t.trim())?`(async()=>{ ${t} })()`:t;let o=(()=>{try{let e=new r(["__self","scope"],`with (scope) { __self.result = ${n} }; __self.finished = true; return __self.result;`);return Object.defineProperty(e,"name",{value:`[Alpine] ${t}`}),e}catch(r){return handleError(r,e,t),Promise.resolve()}})();return evaluatorMemo[t]=o,o}function generateEvaluatorFromString(t,e,r){let n=generateFunctionFromString(e,r);return(o=()=>{},{scope:u={},params:a=[]}={})=>{n.result=void 0,n.finished=!1;let l=mergeProxies([u,...t]);if("function"==typeof n){let t=n(n,l).catch((t=>handleError(t,r,e)));n.finished?(runIfTypeOfFunction(o,n.result,l,a,r),n.result=void 0):t.then((t=>{runIfTypeOfFunction(o,t,l,a,r)})).catch((t=>handleError(t,r,e))).finally((()=>n.result=void 0))}}}export function runIfTypeOfFunction(t,e,r,n,o){if(shouldAutoEvaluateFunctions&&"function"==typeof e){let u=e.apply(r,n);u instanceof Promise?u.then((e=>runIfTypeOfFunction(t,e,r,n))).catch((t=>handleError(t,o,e))):t(u)}else"object"==typeof e&&e instanceof Promise?e.then((e=>t(e))):t(e)}
//# sourceMappingURL=/sm/614c3e442d3738468b386a606c476d8ce4c03e599a54ffc3d33f1d2c02286937.map