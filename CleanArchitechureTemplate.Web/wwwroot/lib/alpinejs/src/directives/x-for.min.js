/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/alpinejs@3.14.9/src/directives/x-for.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{addScopeToNode}from"../scope";import{evaluateLater}from"../evaluator";import{directive}from"../directives";import{reactive}from"../reactivity";import{initTree,destroyTree}from"../lifecycle";import{mutateDom}from"../mutation";import{warn}from"../utils/warn";import{skipDuringClone}from"../clone";directive("for",((e,{expression:t},{effect:r,cleanup:o})=>{let i=parseForExpression(t),l=evaluateLater(e,i.items),n=evaluateLater(e,e._x_keyExpression||"index");e._x_prevKeys=[],e._x_lookup={},r((()=>loop(e,i,l,n))),o((()=>{Object.values(e._x_lookup).forEach((e=>mutateDom((()=>{destroyTree(e),e.remove()})))),delete e._x_prevKeys,delete e._x_lookup}))}));let shouldFastRender=!0;function loop(e,t,r,o){let i=e;r((r=>{isNumeric(r)&&r>=0&&(r=Array.from(Array(r).keys(),(e=>e+1))),void 0===r&&(r=[]);let l=e._x_lookup,n=e._x_prevKeys,a=[],s=[];if("object"!=typeof(c=r)||Array.isArray(c))for(let i=0;i<r.length;i++){let l=getIterationScopeVariables(t,r[i],i,r);o((t=>{s.includes(t)&&warn("Duplicate key on x-for",e),s.push(t)}),{scope:{index:i,...l}}),a.push(l)}else r=Object.entries(r).map((([i,l])=>{let n=getIterationScopeVariables(t,l,i,r);o((t=>{s.includes(t)&&warn("Duplicate key on x-for",e),s.push(t)}),{scope:{index:i,...n}}),a.push(n)}));var c;let p=[],f=[],m=[],u=[];for(let e=0;e<n.length;e++){let t=n[e];-1===s.indexOf(t)&&m.push(t)}n=n.filter((e=>!m.includes(e)));let d="template";for(let e=0;e<s.length;e++){let t=s[e],r=n.indexOf(t);if(-1===r)n.splice(e,0,t),p.push([d,e]);else if(r!==e){let t=n.splice(e,1)[0],o=n.splice(r-1,1)[0];n.splice(e,0,o),n.splice(r,0,t),f.push([t,o])}else u.push(t);d=t}for(let e=0;e<m.length;e++){let t=m[e];t in l&&(mutateDom((()=>{destroyTree(l[t]),l[t].remove()})),delete l[t])}for(let e=0;e<f.length;e++){let[t,r]=f[e],o=l[t],n=l[r],c=document.createElement("div");mutateDom((()=>{n||warn('x-for ":key" is undefined or invalid',i,r,l),n.after(c),o.after(n),n._x_currentIfEl&&n.after(n._x_currentIfEl),c.before(o),o._x_currentIfEl&&o.after(o._x_currentIfEl),c.remove()})),n._x_refreshXForScope(a[s.indexOf(r)])}for(let e=0;e<p.length;e++){let[t,r]=p[e],o="template"===t?i:l[t];o._x_currentIfEl&&(o=o._x_currentIfEl);let n=a[r],c=s[r],f=document.importNode(i.content,!0).firstElementChild,m=reactive(n);addScopeToNode(f,m,i),f._x_refreshXForScope=e=>{Object.entries(e).forEach((([e,t])=>{m[e]=t}))},mutateDom((()=>{o.after(f),skipDuringClone((()=>initTree(f)))()})),"object"==typeof c&&warn("x-for key cannot be an object, it must be a string or an integer",i),l[c]=f}for(let e=0;e<u.length;e++)l[u[e]]._x_refreshXForScope(a[s.indexOf(u[e])]);i._x_prevKeys=s}))}function parseForExpression(e){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,r=e.match(/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/);if(!r)return;let o={};o.items=r[2].trim();let i=r[1].replace(/^\s*\(|\)\s*$/g,"").trim(),l=i.match(t);return l?(o.item=i.replace(t,"").trim(),o.index=l[1].trim(),l[2]&&(o.collection=l[2].trim())):o.item=i,o}function getIterationScopeVariables(e,t,r,o){let i={};if(/^\[.*\]$/.test(e.item)&&Array.isArray(t)){e.item.replace("[","").replace("]","").split(",").map((e=>e.trim())).forEach(((e,r)=>{i[e]=t[r]}))}else if(/^\{.*\}$/.test(e.item)&&!Array.isArray(t)&&"object"==typeof t){e.item.replace("{","").replace("}","").split(",").map((e=>e.trim())).forEach((e=>{i[e]=t[e]}))}else i[e.item]=t;return e.index&&(i[e.index]=r),e.collection&&(i[e.collection]=o),i}function isNumeric(e){return!Array.isArray(e)&&!isNaN(e)}
//# sourceMappingURL=/sm/06a17f4905f82ef0ce1edf93efa2f1703da2a75a7bbb1f800375ba9f61f4eafd.map